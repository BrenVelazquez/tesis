import com.sistexperto.dto.PacienteRequest;
import com.sistexperto.dto.PacienteResponse;
import com.sistexperto.model.Paciente;

global com.sistexperto.dto.PacienteResponse pacienteResponse;
global Boolean posibleEsquizofrenia;
global Boolean noPosibleEsquizofrenia;
global Boolean posibleTemporal;

dialect "mvel"




rule "Sintomas obligatorios - Delirios"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_delirios== "Si" && (sintomas_positivos_alucinaciones=='No se descarta' || sintomas_positivos_alucinaciones=='Si' || sintomas_positivos_tipo_pensamiento=='Disgregacion' || sintomas_positivos_tipo_pensamiento=='incoherencia' || sintomas_negativos_actividad=='Abulia'))
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Dos (o más) de los síntomas principales, cada uno de ellos presente durante una parte significativa de tiempo durante un período de un mes. Al menos uno de ellos ha de ser sintomas_positivos_delirioss, alucionaciones, disgregación o incoherencia.",1)   
end

rule "Sintomas obligatorios - sintomas_positivos_alucinaciones"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_alucinaciones=='Si' && (sintomas_positivos_delirios== "Si" || sintomas_positivos_tipo_pensamiento=='Disgregacion' || sintomas_positivos_tipo_pensamiento=='Incoherencia' || sintomas_negativos_actividad=='Abulia')  )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Dos (o más) de los síntomas principales, cada uno de ellos presente durante una parte significativa de tiempo durante un período de un mes. Al menos uno de ellos ha de ser sintomas_positivos_delirioss, alucionaciones, disgregación o incoherencia.",1)   
end

rule "Sintomas obligatorios - Disgregacion"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_tipo_pensamiento=='Disgregacion' && (sintomas_positivos_delirios== "Si" || sintomas_positivos_alucinaciones=='No se descarta' || sintomas_positivos_alucinaciones=='Si' || sintomas_positivos_tipo_pensamiento=='Incoherencia' || sintomas_negativos_actividad=='Abulia') )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Dos (o más) de los síntomas principales, cada uno de ellos presente durante una parte significativa de tiempo durante un período de un mes. Al menos uno de ellos ha de ser sintomas_positivos_delirioss, alucionaciones, disgregación o incoherencia.",1)   
end

rule "Sintomas obligatorios - Incoherencia"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_tipo_pensamiento=='Incoherencia' && (sintomas_positivos_delirios== "Si" || sintomas_positivos_alucinaciones=='No se descarta' || sintomas_positivos_alucinaciones=='Si' || sintomas_positivos_tipo_pensamiento=='Disgregacion' || sintomas_negativos_actividad=='Abulia')) 
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Dos (o más) de los síntomas principales, cada uno de ellos presente durante una parte significativa de tiempo durante un período de un mes. Al menos uno de ellos ha de ser sintomas_positivos_delirioss, alucionaciones, disgregación o incoherencia.",1)   
end

rule "Sintomas obligatorios - Ninguno"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_delirios=='No' && sintomas_positivos_alucinaciones=='No' && sintomas_positivos_tipo_pensamiento!='Disgregacion' && sintomas_positivos_tipo_pensamiento!='Incoherencia' ) 
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)   
    pacienteResponse.actualizarJustificacion("No presenta sintomas_positivos_alucinaciones, sintomas_positivos_delirios, digregación o incoherencia.",1)   
end




rule "Tiempo - Menor 1 mes"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_duracion < 1 || sintomas_negativos_duracion < 1) 
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("La duración de síntomas sintomas_positivos_duracion o negativos menor a un mes.",1)   
end





rule "Nivel de funcionamiento"
when
    $pacienteRequest: PacienteRequest(sintomas_negativos_aspecto!='Bizarro' || sintomas_negativos_aspecto!='Extravagante' || sintomas_negativos_aspecto!='Inadecuado' || sintomas_negativos_aspecto!='Adelgazado '|| sintomas_negativos_atencion=='Hipoprosexia' || sintomas_negativos_atencion=='Hipomimico' || sintomas_negativos_atencion=='Paraprosexia' || sintomas_negativos_actividad=='Abulia' || sintomas_negativos_actividad=='Hipobulia' || sintomas_negativos_actividad=='Impulsiones' || sintomas_negativos_actividad=='Compulsiones' || sintomas_negativos_actividad=='apraxia' || sintomas_negativos_actividad=='Ataxia' || sintomas_negativos_actividad=='Ecopraxia' || sintomas_negativos_actividad=='Manierismo' || sintomas_negativos_actividad=='Esterotipia' || sintomas_negativos_actividad=='Negativismo' || sintomas_negativos_actividad=='Flexibilidad Cerea' || sintomas_negativos_afectividad=='Aplanamiento afectivo' || sintomas_negativos_afectividad=='Labilidad' || sintomas_negativos_afectividad=='Irritabilidad' || sintomas_negativos_afectividad=='Expansivo' || sintomas_negativos_afectividad=='Inapropiado' || sintomas_negativos_afectividad=='Anhedonia')
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Durante una parte significativa del tiempo desde el inicio del trastorno, el nivel de funcionamiento en uno o más ámbitos principales está muy por debajo del nivel alcanzado antes del inicio .",1)   
end

rule "Nivel de funcionamiento - Normal"
when
    $pacienteRequest: PacienteRequest(!(sintomas_negativos_aspecto!='Bizarro' || sintomas_negativos_aspecto!='Extravagante' || sintomas_negativos_aspecto!='Inadecuado' || sintomas_negativos_aspecto!='Adelgazado '|| sintomas_negativos_atencion=='Hipoprosexia' || sintomas_negativos_atencion=='Hipomimico' || sintomas_negativos_atencion=='Paraprosexia' || sintomas_negativos_actividad=='Abulia' || sintomas_negativos_actividad=='Hipobulia' || sintomas_negativos_actividad=='Impulsiones' || sintomas_negativos_actividad=='Compulsiones' || sintomas_negativos_actividad=='apraxia' || sintomas_negativos_actividad=='Ataxia' || sintomas_negativos_actividad=='Ecopraxia' || sintomas_negativos_actividad=='Manierismo' || sintomas_negativos_actividad=='Esterotipia' || sintomas_negativos_actividad=='Negativismo' || sintomas_negativos_actividad=='Flexibilidad Cerea' || sintomas_negativos_afectividad=='Aplanamiento afectivo' || sintomas_negativos_afectividad=='Labilidad' || sintomas_negativos_afectividad=='Irritabilidad' || sintomas_negativos_afectividad=='Expansivo' || sintomas_negativos_afectividad=='Inapropiado' || sintomas_negativos_afectividad=='Anhedonia'))
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("No presenta nivel de funcionamiento bajo en ambitos principales.",1)   
end



rule "Antecedentes - presencia de delirios o alucionaciones"
when
    $pacienteRequest: PacienteRequest((transtorno_autista=='Si'|| transtorno_comunicacion=='Si') && (sintomas_positivos_alucinaciones=='Si' || sintomas_positivos_delirios=='Si') )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Existen antecedentes de un trastorno del espectro autista o de un trastorno de la comunicación de inicio en la infancia y presenta delirios o alucinaciones.",1)   
end

rule "Antecedentes - sin presencia de sintomas_positivos_delirios o alucionaciones"
when
    $pacienteRequest: PacienteRequest((transtorno_autista=='Si'|| transtorno_comunicacion=='Si') && sintomas_positivos_delirios=='No' && sintomas_positivos_alucinaciones=='no' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Existen antecedentes de un trastorno del espectro autista o de un trastorno de la comunicación de inicio en la infancia pero no posee delirios o alucinaciones.",1)   
end




rule "Diagnosticos descartados"
when
    $pacienteRequest: PacienteRequest(!(transtorno_esquizoafectivo=='Si' && transtorno_bipolar=='Si')  )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 2)
    pacienteResponse.actualizarJustificacion("Se han descartado el trastorno esquizoafectivo y el trastorno depresivo o bipolar con características psicóticas.",1)   
end

rule "Diagnosticos no descartados"
when
    $pacienteRequest: PacienteRequest(transtorno_esquizoafectivo=='Si' || transtorno_bipolar=='Si' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("No se han descartado el trastorno esquizoafectivo y el trastorno depresivo o bipolar con características psicóticas.",1)   
end





rule "Efectos fisiologicos - No"
when
    $pacienteRequest: PacienteRequest(sustancias=='No' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("El trastorno no se puede atribuir a los efectos fisiológicos de una sustancia u otra afección médica.",1)   
end

rule "Efectos fisiologicos - Si"
when
    $pacienteRequest: PacienteRequest(sustancias=='Si' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("El trastorno se puede atribuir a los efectos fisiológicos de una sustancia u otra afección médica.",1)   
end




rule "Causa organica - No"
when
    $pacienteRequest: PacienteRequest(estudio_causa_natural=='No' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("Se descarta causa orgánica.",1)   
end

rule "Causa organica - Si"
when
    $pacienteRequest: PacienteRequest(estudio_causa_natural=='Si' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("No se descarta causa orgánica.",1)   
end




rule "PUNTAJE: Alucinaciones - Si"
when
    $pacienteRequest: PacienteRequest( sintomas_positivos_tipo_alucinaciones!='No se descarta' )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 3)
    pacienteResponse.actualizarJustificacion("Presenta alucinaciones.",1)   
end

rule "PUNTAJE: Alucinaciones - No se descarta"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_alucinaciones=='No se descarta'  )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 2)
    pacienteResponse.actualizarJustificacion("No se descartan alucinaciones.",1)   
end

rule "PUNTAJE: Alucinaciones - No"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_alucinaciones=='No'  )
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 2)
    pacienteResponse.actualizarJustificacion("No posee alucinaciones.",1)   
end





rule "PUNTAJE: Delirios - Si"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_delirios=='Si')
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 3)
    pacienteResponse.actualizarJustificacion("Presenta delirios.",1)   
end

rule "PUNTAJE: Delirios - No"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_delirios=='No')
then
    pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
    pacienteResponse.actualizarJustificacion("No presenta delirios.",1)   
end




rule "PUNTAJE: Edad - No adolescente"
when
    $pacienteRequest: PacienteRequest(edad >= 11 || (edad >= 19 && edad <= 59))
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 1)
        pacienteResponse.actualizarJustificacion("No es adolescente",1)   
end

rule "PUNTAJE: Edad - Adolescente "
when
    $pacienteRequest: PacienteRequest(edad >= 12 && edad <= 18 )
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 3)
        pacienteResponse.actualizarJustificacion("No es adolescente",1)   
end

rule "PUNTAJE: Edad - Mayor "
when
    $pacienteRequest: PacienteRequest(edad > 59 )
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 0)
        pacienteResponse.actualizarJustificacion("Adulto mayor",1)   
end




rule "PUNTAJE: Tipo de lenguaje - Particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_lenguaje == 'taquilalia' || sintomas_positivos_tipo_lenguaje == 'Verborragia' || sintomas_positivos_tipo_lenguaje == 'Bradilalia' || sintomas_positivos_tipo_lenguaje == 'Latencia' || sintomas_positivos_tipo_lenguaje == 'Mutismo')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 1)
        pacienteResponse.actualizarJustificacion("Lenguaje con particularidades",1)   
end

rule "PUNTAJE: Tipo de lenguaje - Principales"
when
    $pacienteRequest: PacienteRequest(!(sintomas_positivos_tipo_lenguaje == 'taquilalia' || sintomas_positivos_tipo_lenguaje == 'Verborragia' || sintomas_positivos_tipo_lenguaje == 'Bradilalia' || sintomas_positivos_tipo_lenguaje == 'Latencia' || sintomas_positivos_tipo_lenguaje == 'Mutismo') && sintomas_positivos_tipo_lenguaje!='Sin particularidades')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() + 2)
        pacienteResponse.actualizarJustificacion("Lenguaje con particularidades características de esquizofrenia",1)   
end

rule "PUNTAJE: Tipo de lenguaje - Sin particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_lenguaje=='Sin particularidades')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +0 )
        pacienteResponse.actualizarJustificacion("Lenguaje sin particularidades ",1)   
end




rule "PUNTAJE: Pensamiento - principales"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_pensamiento=='Disgregación' || sintomas_positivos_tipo_pensamiento=='Incoherencia')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +3 )
        pacienteResponse.actualizarJustificacion("Pensamiento con particularidades características de esquizofrenia",1)   
end

rule "PUNTAJE: Pensamiento - Particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_pensamiento!='Sin particularidades' && sintomas_positivos_tipo_pensamiento!='Disgregación' && sintomas_positivos_tipo_pensamiento!='Incoherencia')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +2 )
        pacienteResponse.actualizarJustificacion("Pensamiento con particularidades",1)   
end

rule "PUNTAJE: Pensamiento - Sin particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_pensamiento=='Sin particularidades')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +0 )
        pacienteResponse.actualizarJustificacion("Pensamiento sin particularidades",1)   
end




rule "PUNTAJE: Ritmo pensamiento - particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_ritmo_pensamiento != "Sin particularidades")
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +1 )
        pacienteResponse.actualizarJustificacion("Ritmo de pensamiento con particularidades",1)   
end

rule "PUNTAJE: Ritmo pensamiento - sin particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_ritmo_pensamiento =="Sin particularidades")
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +0 )
        pacienteResponse.actualizarJustificacion("Ritmo de pensamiento sin particularidades",1)   
end




rule "PUNTAJE: Contenido pensamiento - particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_contenido_pensamiento!='Sin particularidades')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +1 )
        pacienteResponse.actualizarJustificacion("Contenido de pensamiento con particularidades",1)   
end

rule "PUNTAJE: Contenido pensamiento - sin particularidades"
when
    $pacienteRequest: PacienteRequest(sintomas_positivos_tipo_contenido_pensamiento=='Sin particularidades')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +0 )
        pacienteResponse.actualizarJustificacion("Contenido de pensamiento sin particularidades",1)   
end




rule "PUNTAJE: Antecedentes familiares - Si"
when
    $pacienteRequest: PacienteRequest(antecedentes_familiares=='Si')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +2 )
        pacienteResponse.actualizarJustificacion("Antecedentes familiares psiquiatricos",1)   
end

rule "PUNTAJE: Antecedentes familiares - No"
when
    $pacienteRequest: PacienteRequest(antecedentes_familiares=='No')
then
    
        pacienteResponse.setPuntaje(pacienteResponse.getPuntaje() +0 )
        pacienteResponse.actualizarJustificacion("Sin antecedentes familiares psiquiatricos",1)   
end


